<div class="split-layout">
  <!-- LEFT PANEL: Animation & Branding -->
  <div class="left-panel">
    <div class="panel-content">
      <div class="brand-badge">
        <i class="fas fa-vote-yea"></i> SecureVote
      </div>

      <div class="hero-content">
        <h1>Cast Your<br><span>Vote Now.</span></h1>
        <p>Your voice matters. Securely select your preferred candidate and participate in democracy.</p>
      </div>

      <!-- Animation Stage (Polling Box) -->
      <div class="animation-stage">
        <div class="polling-animation">
          <div class="ballot-paper">
            <i class="fas fa-check"></i>
          </div>
          <div class="ballot-box">
            <div class="box-lid"></div>
            <div class="box-body">
              <i class="fas fa-vote-yea"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- Background Circles -->
      <div class="circle circle-1"></div>
      <div class="circle circle-2"></div>
    </div>
  </div>

  <!-- RIGHT PANEL: Voting Interaction -->
  <div class="right-panel">
    <div class="form-container">

      <!-- Back Button -->
      <button class="btn-back" (click)="goBackToDashboard()">
        <i class="fas fa-arrow-left"></i> Dashboard
      </button>

      <!-- Election Info Header -->
      <div class="form-header" *ngIf="selectedElection">
        <div class="election-meta">
          <span class="status-pill active">Active Election</span>
          <span class="eligibility-tag"><i class="fas fa-check-circle"></i> Eligible</span>
        </div>
        <h2>{{ selectedElection.name }}</h2>
        <div class="meta-row">
          <span><i class="far fa-calendar-alt"></i> Ends: {{ formatDate(selectedElection.endDate) }}</span>
          <span class="time-remaining"><i class="far fa-clock"></i> {{ getTimeRemaining(selectedElection.endDate) }}
            left</span>
        </div>
      </div>

      <!-- Content Area -->
      <div class="voting-content-area" *ngIf="selectedElectionId">

        <!-- Loading State -->
        <div class="state-box" *ngIf="isLoading">
          <div class="spinner"></div>
          <p>Loading candidates...</p>
        </div>

        <!-- No Candidates -->
        <div class="state-box empty" *ngIf="!isLoading && candidates.length === 0">
          <i class="fas fa-box-open"></i>
          <p>No candidates found for this election.</p>
        </div>

        <!-- Candidates Grid -->
        <!-- Candidates List -->
        <!-- EVM Interface -->
        <!-- Candidates List -->
        <div class="candidates-list" *ngIf="!isLoading && candidates.length > 0">
          <div class="candidate-item" *ngFor="let candidate of candidates; let i = index"
            [class.selected]="selectedCandidateId === candidate.candidateId" [style.animation-delay]="i * 0.05 + 's'"
            (click)="selectCandidate(candidate.candidateId)">

            <div class="item-left">
              <div class="avatar-circle-sm">
                {{ candidate.name.charAt(0) }}
              </div>

              <div class="candidate-info-game">
                <h3>{{ candidate.name }}</h3>
                <div class="meta-tags-sm">
                  <span class="tag party" [class.independent]="!candidate.partyId">
                    {{ getPartyName(candidate.partyId) || 'Independent' }}
                  </span>
                  <span class="tag id">#{{ candidate.candidateId }}</span>
                </div>
              </div>
            </div>

            <div class="item-right">
              <div class="selection-check" *ngIf="selectedCandidateId === candidate.candidateId">
                <i class="fas fa-check"></i>
              </div>
              <button class="btn-select-sm">
                {{ selectedCandidateId === candidate.candidateId ? 'Selected' : 'Select' }}
              </button>
            </div>

          </div>
        </div>

      </div>

      <!-- Voting Actions Footer -->
      <div class="form-actions" *ngIf="selectedCandidateId">
        <div class="selection-summary">
          <span>Voting for:</span>
          <strong>{{ getSelectedCandidateName() }}</strong>
        </div>
        <button class="btn-confirm-vote" (click)="openConfirmationCard()" [disabled]="isLoading">
          Confirm Vote <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <!-- Messages -->
      <div class="message-box error" *ngIf="error">
        <i class="fas fa-exclamation-circle"></i> {{ error }}
      </div>
      <div class="message-box success" *ngIf="success">
        <i class="fas fa-check-circle"></i> {{ success }}
      </div>

    </div>
  </div>

  <!-- Confirmation Modal (Outside panels) -->
  <div class="modal-overlay" *ngIf="showConfirmationCard" (click)="closeConfirmationCard()">
    <div class="modal-card" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Confirm Your Vote</h3>
        <button class="close-icon" (click)="closeConfirmationCard()"><i class="fas fa-times"></i></button>
      </div>

      <div class="modal-body" *ngIf="selectedCandidateName">
        <div class="confirm-intro">
          You are about to cast your vote for:
        </div>

        <div class="candidate-highlight">
          <div class="lg-avatar">{{ selectedCandidateName.charAt(0) }}</div>
          <div class="details">
            <h4>{{ selectedCandidateName }}</h4>
            <p>Party ID: {{ getSelectedCandidate()?.partyId }} â€¢ Ward: {{ getSelectedCandidate()?.wardId }}</p>
          </div>
        </div>

        <div class="warning-box">
          <i class="fas fa-exclamation-circle"></i>
          <p>This action cannot be undone. Please confirm your choice.</p>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-cancel" (click)="closeConfirmationCard()" [disabled]="isLoading">Cancel</button>
        <button class="btn-confirm" (click)="confirmVote()" [disabled]="isLoading">
          <span *ngIf="!isLoading">Submit Vote</span>
          <span *ngIf="isLoading"><i class="fas fa-spinner fa-spin"></i> Submitting...</span>
        </button>
      </div>
    </div>
  </div>

</div>